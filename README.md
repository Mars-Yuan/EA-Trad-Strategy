# EA Trad Strategy
EA Expert Automated trading strategies
## 交易是门古老而又现代的学科，是人类社会运转基础。每天全球金融产品交易有价证券市场的交易量大约为3000亿美元，而每天外汇交易量将近6万亿美元。有价证券交易70%和外汇交易90%以上都是通过自动程序及算法交易完成.

对比中国金融及资本市场发展现状还有非常大的改善空间。特别是机器程序交易EA（Expert Advisors and Indicators ）策略在中国基本是空白，2015年各大中国券商都开始内测程序化交易平台，2018年券商开始向公众市场推广程序交易平台的应用。

2019年12月中国第二个指数期货沪深300ETF开埠。这意味中国金融衍生品及高阶交易市场重新步入发展轨道，对于中国当前的资产定价失锚和重构起到举足轻重作用。将Python作为金融工程仿真和交易平台引入中国金融工程学科研究和量化自动交易构建，促进金融工程学科在中国发展和全球交易体系对接实践。

本系列案例目标形成 EA（Expert Advisors and Indicators ）机器自动交易策略，通过GitHub开源形成一批真正有实战价值的EA成果。

## **案例1：Bidding OC Model (Yahoo Data Source).ipynb**

  __策略设计说明：__

   **策略信号:**

     每交易日竞价阶段最后的竞价价格（开盘价替代） > 上一交易日的收盘价

   **策略应用：**
   
   以中国A股举例，每交易日9:26竞价最终价格 判断 是否大于上一交易日收盘价则买入，否则卖出。此策略信号对于股票、ETF全市场标的金融时序进行15年历史数据回测具备普遍的领先性,并实盘在恒生电子Ptrade系统实盘连续运行2年余取得持续稳定的收益。
   
   该EA策略的特点是对周线持续上涨波段的收益数倍增厚，远超直接持有的收益水平。

   注意：该策略核心作用是作为交易策略消除回撤、减小方差使用。

   __策略运行需要安装以下库：__

    pip install PyQt5  -i https://pypi.tuna.tsinghua.edu.cn/simple
    pip install pandas-datareader
    pip install yfinance --upgrade --no-cache-dir
    pip install backtrader


## **案例2：Top10 ETF Optimal Portfolio V1.1 - Git**

  __策略设计说明：__

  **策略原理:**
    通过Tushare接口对A股Qdii基金的读取数据，运用现代资产组合理论（Modern Portfolio Theory，简称MPT） 以及由哈里·马可维茨（Harry Markowitz）提出的马可维茨模型（Markowitz Model）。把前10日平均交易额最大10支ETF基金排序选择，最终对比确定最优sharp率和最小方差的组合权重比例，和收益曲线对比，图示非常完美，已经可以实用状态！
    
  
  Tushare 开源金融数据源是中国几位金融数据爱好者组建的免费开源的金融数据社区，目前在中国Tushare是最全面的开源免费数据，这非常不容易。金融数据提供是有严格法律责任其有效性真实性在中国受到严格法律法规监管。Tushare的创建者是以历史数据的形式提供A股票、期货、债券数据，不提供实时数据；但是区块链及数字货币不涉及中国法规所以提供实时数据。

  Tushare除提供全面的金融数据源 股票 指数 期货 期指 债券 甚至还有区块链 数字货币。Tushare Token 根据调用性能不同而采取免费或不同的收费策略，详见：https://tushare.pro/

  **策略应用:**

   注意：该策略的核心作用是Markowitz Model 最优sharp率和最小方差的标的组合权重比例对比列表筛选出来。
   可以看出中国Qdii的ETF基金组合 回撤都>5%（要注意回撤必须<5%的EA才具备实际运行的价值），因此还需要配合消除回撤交易策略一并应用，可以结合案例1：Bidding OC Model (Yahoo Data Source).ipynb作为交易策略降低回撤，形成完整的机器程序交易EA（Expert Advisors and Indicators ）系统。


## **EA（Expert Advisors and Indicators ）系统的实用化核心难点**

  __EA进阶创研的阶段难点__

   **第1种三角不可能的矛盾**
   
   “高收益 高频度 高赢率” 第1种三角不可能的矛盾是在量化学习创研中最早遇到的难点，往往困境源于量化模型设计原理基于对资产价格的各种预测算法，金融时序是一种高度混合数据，其中有可以周期分解的趋势数据段也有“边沿效应”的突变数据段，由此而产生这种三角的矛盾。
   
   要知道投资和赌博的区别是什么？二者都是建立在对资产价格未来的“预期”，但是从预期到价值实现中间有着一道难以逾越的墙，这堵墙就是“交易策略”。
   
   赌博就是将对资产价格预期预测不加任何交易策略直接投入坐等收益，变成了资产价格预期实现100%概率的上帝的“圣杯”？
   
   投资是对资产价格的“预期”与价值实现之间，建立一座“交易策略之桥”，交易策略不能依赖价格的预测，所有对资产价格预测的“圣杯”都不可能存在。
   
   投资的“交易策略之桥”是通过策略消除“圣杯”带来的高方差波段风险，严格的控制回撤<5%才具备实际的量化模型的实际运行的意义，因此破解这个三角关系核心是“控制回撤”的交易策略。
   
   图例说明：
   
   ![回撤原理](https://github.com/user-attachments/assets/d9707c36-3503-404a-a93b-161dc54db488)

   
   任何资产回撤只要超过5%就变成了赌其可以回归大于5%以上才可以止损盈利，这本身就是在赌“圣杯”的存在。而投资恰恰要通过策略规避这种赌博，通过交易频度形成一次次的积累的正收益形成所谓的“阿尔法”。

   **第2种三角不可能的矛盾**
   
   “高收益 低回撤 大容量”第2种三角不可能的矛盾，是在完成了第1种三角不可能的矛盾后形成低于5%回撤的策略在实际运行过程中才可以发现的障碍，其主要体现在交易策略的时间频度越低，其时间点截面的交易容量就变得很小，从而导致EA实际运行很难达到模型策略的设计要求。这个阶段就想要根据标的组合的实际情况调整选择交易周期或者交易策略，达到交易频度形成一次次的积累的正收益形成所谓的“阿尔法”。
   

